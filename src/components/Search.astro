---
---

<div id="search" class="pagefind-ui-container"></div>

<script is:inline>
  window.addEventListener('DOMContentLoaded', (event) => {
    // We only initialize if the element exists and PagefindUI is loaded
    // Note: Pagefind is a post-build tool, so this will only work in production/preview
    if (document.querySelector('#search') && typeof PagefindUI !== 'undefined') {
      new PagefindUI({ 
        element: "#search", 
        showSubResults: true,
        translations: {
          placeholder: "Search worksheets..."
        }
      });
    }
  });

  // Handle Astro View Transitions
  document.addEventListener('astro:page-load', () => {
    if (document.querySelector('#search') && typeof PagefindUI !== 'undefined') {
        // Clear existing to avoid double initialization if needed
        const searchEl = document.querySelector('#search');
        if (searchEl) searchEl.innerHTML = '';
        
        new PagefindUI({ 
            element: "#search", 
            showSubResults: true,
            translations: {
                placeholder: "Search worksheets..."
            }
        });
    }
  });
</script>

<style is:global>
  /* Customize Pagefind UI to match project theme */
  :root {
    --pagefind-ui-primary: lightgrey;
    --pagefind-ui-text: black;
    --pagefind-ui-background: #ffffff;
    --pagefind-ui-border: #e2e8f0;
    --pagefind-ui-tag: #f1f5f9;
    --pagefind-ui-border-radius: 12px;
    --pagefind-ui-font: inherit;
  }

  .pagefind-ui-container {
    width: 100%;
    position: relative; /* Base for absolute drawer */
  }

  .pagefind-ui .pagefind-ui__search-input {
    font-weight: 500 !important;
    border: 1px solid rgba(255, 255, 255, 0.2) !important;
    background-color: rgba(255, 255, 255, 0.1) !important;
    color: white !important;
    box-shadow: none !important;
    height: 36px !important;
  }

  .pagefind-ui .pagefind-ui__search-input::placeholder {
    color: rgba(255, 255, 255, 0.6) !important;
  }

  .pagefind-ui .pagefind-ui__search-input:focus {
    border-color: var(--pagefind-ui-primary) !important;
    outline: none !important;
    ring: 2px solid var(--pagefind-ui-primary) !important;
  }
  
  /* Make the search results an overlay */
  .pagefind-ui .pagefind-ui__drawer {
      position: absolute !important;
      top: 100% !important;
      right: 0 !important;
      width: 400px !important;
      max-width: calc(100vw - 2rem) !important;
      background: white !important;
      border: 1px solid var(--pagefind-ui-border) !important;
      border-radius: 12px !important;
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05) !important;
      margin-top: 0.5rem !important;
      padding: 1rem !important;
      max-height: 70vh !important;
      overflow-y: auto !important;
      z-index: 1000 !important;
  }

  /* Compact the form */
  .pagefind-ui .pagefind-ui__form {
      padding-bottom: 0 !important;
  }

  .pagefind-ui .pagefind-ui__result-link {
    color: #2563eb !important;
    font-weight: 700 !important;
    text-decoration: none !important;
  }

  .pagefind-ui .pagefind-ui__result-link:hover {
    text-decoration: underline !important;
  }
</style>


<!-- Standard Pagefind UI assets - these are generated into /pagefind/ after build -->
<!-- In dev mode, these will 404, which is expected -->
<link href="/pagefind/pagefind-ui.css" rel="stylesheet">
<script src="/pagefind/pagefind-ui.js" is:inline></script>
